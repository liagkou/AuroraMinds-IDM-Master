FROM adoptopenjdk/openjdk13:jre-13.0.2_8-alpine

LABEL Description="Dockerfile for an OLYMPUS test server" Vendor="Alexandra Institute A/S" Version="0.0.1"

COPY /target/OIDC-IdP-jar-with-dependencies.jar /app/
COPY /target/libs /app/libs/

# Autogenerated configuration + keystores:
COPY /src/test/resources/sqlite-jdbc-3.30.1.jar /app/db/sqlite.jar
COPY /src/test/resources/volatile/auto-server-0.json /app/config/server1.json
COPY /src/test/resources/volatile/auto-server-1.json /app/config/server2.json
COPY /src/test/resources/volatile/auto-server-2.json /app/config/server3.json
COPY /src/test/resources/volatile/server-0.jks /app/config/server-1.jks
COPY /src/test/resources/volatile/server-1.jks /app/config/server-2.jks
COPY /src/test/resources/volatile/server-2.jks /app/config/server-3.jks
COPY /src/test/resources/volatile/truststore.jks /app/config/truststore.jks

ENTRYPOINT ["java", "-jar", "app/OIDC-IdP-jar-with-dependencies.jar"]
